# Merge This Worktree

Branch: {{.BranchName}}
Target: {{.TargetBranch}}
Worktree: {{.WorktreePath}}
Main repo: /workspace

## Instructions

Help the user merge this worktree branch to the target branch.

1. Check for uncommitted changes: `git status`
   - If dirty, ask user: commit, stash, or abort?

2. Fetch latest: `git -C /workspace fetch origin`

3. Check if target has moved:
   - `git -C /workspace log {{.TargetBranch}}..origin/{{.TargetBranch}} --oneline`
   - If commits exist, ask if user wants to update target first

4. Perform merge:
   - `git -C /workspace checkout {{.TargetBranch}} && git merge {{.BranchName}}`
   - Ask user about merge strategy (ff, no-ff, squash) if they have preference

5. If conflict:
   - Show conflicted files
   - Help resolve conversationally
   - Don't leave user in broken state

6. After successful merge:
   - `git -C /workspace worktree remove {{.WorktreePath}}`
   - `git -C /workspace branch -d {{.BranchName}}`
   - Confirm cleanup complete
