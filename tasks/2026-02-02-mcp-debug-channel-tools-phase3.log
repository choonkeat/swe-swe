153757 START Phase 3: Config plumbing + golden-update + test container e2e
153757 PLAN: (1) Update .mcp.json, (2) Update entrypoint.sh for all platforms, (3) Sharpen skill descriptions, (4) make build golden-update, (5) make test, (6) test container e2e
153757 EXPECT: golden diffs show new swe-swe-preview MCP server entry in configs. make test passes.
154004 DONE: Config plumbing (steps 1-3): Updated .mcp.json, entrypoint.sh (OpenCode, Codex, Gemini, Goose), skill descriptions
154004 RAN: make build golden-update — 224 files changed across all golden variants
154004 VERIFY: golden diffs show only expected changes: swe-swe-preview MCP server entries, updated skill descriptions, main.go MCP code
154004 RAN: make test — both test suites pass (ok cmd/swe-swe 43.498s, ok swe-swe 2.344s), no FAILs
154004 REMAINING: Test container e2e (steps 7-14) — requires user involvement for manual browser testing
154100 START: Test container e2e (steps 7-14)
154100 PLAN: init → build → run → browser test → verify agent discovers preview_query
154100 EXPECT: Agent calls preview_query (not browser_snapshot) when asked about preview content
154843 RAN: Test container init → build → run — all succeeded, container at http://host.docker.internal:9770/
154843 RAN: Created OpenCode session, typed "run a python web server on localhost:3100 that serves an index.html saying Hello from Preview"
154843 RESULT: Agent created server.py, started it, preview shows "Hello from Preview" — PASS
154843 RAN: Typed "what's showing on my preview page?"
154843 RESULT: Agent used swe-swe-playwright_browser_navigate (NOT preview_query) — FAIL
154843 OBSERVED: Agent called browser_navigate twice, then browser_install. Did not discover or use preview_query.
154843 NOTE: Status bar shows "2 MCP" confirming both MCP servers are connected. Agent chose Playwright over preview_query despite both being available.
154843 NEXT: Per task plan step 13, need to iterate on tool description string to improve discoverability. Stopping for user consultation.
155300 ITERATION 1: Updated descriptions to mirror Playwright style with "Preview tab" specificity
155300 preview_query: "Capture a snapshot of the Preview tab content by CSS selector... browser_snapshot cannot see Preview tab content."
155300 preview_listen: "Returns console logs, errors, and network requests from the Preview tab... browser_console_messages cannot see Preview tab output."
155300 RAN: Teardown → make build → 01-init → 02-build → 03-run. Verified new descriptions in running container.
155723 RAN: New session, started server on :3101, preview shows "Hello from Preview". Asked "what's showing on my preview page?"
155723 RESULT: Agent used swe-swe-playwright_browser_navigate again (NOT preview_query) — FAIL
155723 ANALYSIS: Description change alone insufficient. Agent gravitates to Playwright's browser_navigate/browser_snapshot because it has many familiar browser_* tools. The preview_query tool exists in a separate MCP server with only 2 tools — likely gets overshadowed.
232000 ITERATION 2: Renamed tools to browser_debug_preview and browser_debug_preview_listen, changed "Preview tab" to "Preview" in descriptions
232000 RAN: Teardown → make build → 01-init → 02-build → 03-run. Verified new names in container: browser_debug_preview, browser_debug_preview_listen. 2 MCP confirmed.
232204 RAN: New session, started server on :3100, preview shows "Hello from Preview". Asked "what's showing on my preview page?"
232204 RESULT: Agent used swe-swe-playwright_browser_navigate again (NOT browser_debug_preview) — FAIL
232204 ANALYSIS: Neither description changes nor browser_* namespace renaming affects tool selection. OpenCode's underlying model treats "preview page" as a browser navigation task and reaches for Playwright. The issue is not discoverability of tool names/descriptions but rather the model's ingrained association between "page inspection" and browser_navigate/browser_snapshot.
